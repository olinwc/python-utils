import numpy as np
import matplotlib.pyplot as plt

time_1 = [5.184e+7]

diff_1 = [0.0621]

cumul_diff_1 = [0.0621]

time_2 = [2.592e+7, 5.184e+7]

diff_2 = [0.0616, -0.0177]

cumul_diff_2 = [0.0616, 0.0219]

time_4 = [1.296e+7, 2.592e+7, 3.888e+7, 5.184e+7]

diff_4 = [0.0465, 0.0087, -0.0085, -0.0195]

cumul_diff_4 = [0.0465, 0.0276, 0.0156, 0.0068]

time_8 = [6.48e+6, 1.296e+7, 1.944e+7, 2.592e+7, 3.24e+7, 3.888e+7, 4.536e+7, 5.184e+7]

diff_8 = [0.0318, 0.0172, 0.0071, 0.00, -0.0055, -0.0101, -0.0141, -0.0176]

cumul_diff_8 = [0.0318, 0.0245, 0.0187, 0.014, 0.0101, 0.0067, 0.0038, 0.0011]

time_16 = [3.2400E+06, 6.4800E+06, 9.7200E+06, 1.2960E+07, 1.6200E+07, 1.9440E+07, 2.2680E+07, 2.5920E+07, 2.9160E+07, 3.2400E+07, 3.5640E+07, 3.8880E+07, 4.2120E+07, 4.5360E+07, 4.8600E+07, 5.1840E+07]

diff_16 = [0.0216, 0.0176, 0.0126, 0.0087, 0.0053, 0.0024, -0.0001, -0.0025, -0.0046, -0.0066, -0.0084, -0.0101, -0.0117, -0.0132, -0.0147, -0.016]

cumul_diff_16 = [0.0216, 0.0196, 0.0173, 0.0151, 0.0132, 0.0114, 0.0097, 0.0082, 0.0068, 0.0055, 0.0042, 0.0030, 0.0019, 0.0008, -0.0002, -0.00012]

time_32 = [1.6200E+06, 3.2400E+06, 4.8600E+06, 6.4800E+06, 8.1000E+06, 9.7200E+06, 1.1340E+07, 1.2960E+07, 1.4580E+07, 1.6200E+07, 1.7820E+07, 1.9440E+07, 2.1060E+07, 2.2680E+07, 2.4300E+07, 2.5920E+07, 2.7540E+07, 2.9160E+07, 3.0780E+07, 3.2400E+07, 3.4020E+07, 3.5640E+07, 3.7260E+07, 3.8880E+07, 4.0500E+07, 4.2120E+07, 4.3740E+07, 4.5360E+07, 4.6980E+07, 4.8600E+07, 5.0220E+07, 5.1840E+07]

diff_32 =       [0.0158, 0.0157, 0.0135, 0.0116, 0.0099, 0.0083, 0.0068, 0.0055, 0.0042, 0.0029, 0.0018, 0.0007, -0.0004, -0.0014, -0.0024, -0.0034, -0.0043, -0.0051, -0.0060, -0.0068, -0.0076, -0.0084, -0.0091, -0.0099, -0.0106, -0.0113, -0.0120, -0.0126, -0.0133, -0.0139, -0.0145, -0.0151]

cumul_diff_32 = [0.0158, 0.0158, 0.0150, 0.0142, 0.0133, 0.0125, 0.0117, 0.0109, 0.0102, 0.0094, 0.0087, 0.0081,  0.0074,  0.0068,  0.0062,  0.0056,  0.0050,  0.0044,  0.0039,  0.0033,  0.0028,  0.0023,  0.0018,  0.0013,  0.0009,  0.0004, -0.0001, -0.0005, -0.0010, -0.0014, -0.0018, -0.0022]

time_64 = [810000, 1620000, 2430000, 3240000, 4050000, 4860000, 5670000, 6480000, 7290000, 8100000, 8910000, 9720000, 10530000, 11340000, 12150000, 12960000, 13770000, 14580000, 15390000, 16200000, 17010000, 17820000, 18630000, 19440000, 20250000, 21060000, 21870000, 22680000, 23490000, 24300000, 25110000, 25920000, 26730000, 27540000, 28350000, 29160000, 29970000, 30780000, 31590000, 32400000, 33210000, 34020000, 34830000, 35640000, 36450000, 37260000, 38070000, 38880000, 39690000, 40500000, 41310000, 42120000, 42930000, 43740000, 44550000, 45360000, 46170000, 46980000, 47790000, 48600000, 49410000, 50220000, 51030000, 51840000]

diff_64 =       [0.0130, 0.0138, 0.0130, 0.0121, 0.0113, 0.0105, 0.0098, 0.0091, 0.0084, 0.0077, 0.0071, 0.0064, 0.0058, 0.0052, 0.0046, 0.0041, 0.0035, 0.0029, 0.0024, 0.0019, 0.0014, 0.0009, 0.0004, -0.0001, -0.0006, -0.0011, -0.0015, -0.0020, -0.0024, -0.0029, -0.0033, -0.0037, -0.0041, -0.0045, -0.0050, -0.0054, -0.0057, -0.0061, -0.0065, -0.0069, -0.0073, -0.0076, -0.0080, -0.0083, -0.0087, -0.0090, -0.0094, -0.0097, -0.0101, -0.0104, -0.0107, -0.0110, -0.0114, -0.0117, -0.0120, -0.0123, -0.0126, -0.0129, -0.0132, -0.0135, -0.0138, -0.0141, -0.0144, -0.0146]

cumul_diff_64 = [0.0130, 0.0134, 0.0133, 0.0130, 0.0127, 0.0123, 0.0119, 0.0116, 0.0112, 0.0109, 0.0105, 0.0102, 0.0099, 0.0095, 0.0092, 0.0089, 0.0086, 0.0083, 0.0079, 0.0076, 0.0073, 0.0070, 0.0068,  0.0065,  0.0062,  0.0059,  0.0056,  0.0054,  0.0051,  0.0048,  0.0046,  0.0043,  0.0041,  0.0038,  0.0035,  0.0033,  0.0031,  0.0028,  0.0026,  0.0023,  0.0021,  0.0019,  0.0016,  0.0014,  0.0012,  0.0010,  0.0007,  0.0005,  0.0003,  0.0001, -0.0001, -0.0003, -0.0005, -0.0007, -0.0009, -0.0011, -0.0013, -0.0015, -0.0017, -0.0019, -0.0021, -0.0023, -0.0025, -0.0027]

time_128 = [405000, 810000, 1215000, 1620000, 2025000, 2430000, 2835000, 3240000, 3645000, 4050000, 4455000, 4860000, 5265000, 5670000, 6075000, 6480000, 6885000, 7290000, 7695000, 8100000, 8505000, 8910000, 9315000, 9720000, 10125000, 10530000, 10935000, 11340000, 11745000, 12150000, 12555000, 12960000, 13365000, 13770000, 14175000, 14580000, 14985000, 15390000, 15795000, 16200000, 16605000, 17010000, 17415000, 17820000, 18225000, 18630000, 19035000, 19440000, 19845000, 20250000, 20655000, 21060000, 21465000, 21870000, 22275000, 22680000, 23085000, 23490000, 23895000, 24300000, 24705000, 25110000, 25515000, 25920000, 26325000, 26730000, 27135000, 27540000, 27945000, 28350000, 28755000, 29160000, 29565000, 29970000, 30375000, 30780000, 31185000, 31590000, 31995000, 32400000, 32805000, 33210000, 33615000, 34020000, 34425000, 34830000, 35235000, 35640000, 36045000, 36450000, 36855000, 37260000, 37665000, 38070000, 38475000, 38880000, 39285000, 39690000, 40095000, 40500000, 40905000, 41310000, 41715000, 42120000, 42525000, 42930000, 43335000, 43740000, 44145000, 44550000, 44955000, 45360000, 45765000, 46170000, 46575000, 46980000, 47385000, 47790000, 48195000, 48600000, 49005000, 49410000, 49815000, 50220000, 50625000, 51030000, 51435000, 51840000]

diff_128 =       [0.0120, 0.0123, 0.0122, 0.0119, 0.0116, 0.0112, 0.0109, 0.0105, 0.0102, 0.0098, 0.0095, 0.0092, 0.0089, 0.0085, 0.0082, 0.0079, 0.0076, 0.0073, 0.0070, 0.0067, 0.0064, 0.0061, 0.0058, 0.0056, 0.0053, 0.0050, 0.0047, 0.0045, 0.0042, 0.0039, 0.0037, 0.0034, 0.0031, 0.0029, 0.0026, 0.0024, 0.0021, 0.0019, 0.0016, 0.0014, 0.0012, 0.0009, 0.0007, 0.0004, 0.0002, 0.0000, -0.0002, -0.0005, -0.0007, -0.0009, -0.0011, -0.0014, -0.0016, -0.0018, -0.0020, -0.0022, -0.0024, -0.0027, -0.0029, -0.0031, -0.0033, -0.0035, -0.0037, -0.0039, -0.0041, -0.0043, -0.0045, -0.0047, -0.0049, -0.0051, -0.0052, -0.0054, -0.0056, -0.0058, -0.0060, -0.0062, -0.0064, -0.0065, -0.0067, -0.0069, -0.0071, -0.0073, -0.0074, -0.0076, -0.0078, -0.0080, -0.0081, -0.0083, -0.0085, -0.0086, -0.0088, -0.0090, -0.0091, -0.0093, -0.0095, -0.0096, -0.0098, -0.0100, -0.0101, -0.0103, -0.0104, -0.0106, -0.0107, -0.0109, -0.0111, -0.0112, -0.0114, -0.0115, -0.0117, -0.0118, -0.0120, -0.0121, -0.0123, -0.0124, -0.0126, -0.0127, -0.0128, -0.0130, -0.0131, -0.0133, -0.0134, -0.0136, -0.0137, -0.0138, -0.0140, -0.0141, -0.0143, -0.0144]

cumul_diff_128 = [0.011963349, 0.012123432, 0.012162182, 0.012105222, 0.011999397, 0.011868439, 0.011723962, 0.011571934, 0.011415624, 0.011256927, 0.011096997, 0.010936566, 0.010776110, 0.010615948, 0.010456297, 0.010297307, 0.010139080, 0.009981688, 0.009825181, 0.009669590, 0.009514939, 0.009361239, 0.009208498, 0.009056719, 0.008905900, 0.008756037, 0.008607125, 0.008459158, 0.008312127, 0.008166023, 0.008020838, 0.007876561, 0.007733184, 0.007590695, 0.007449084, 0.007308342, 0.007168459, 0.007029423, 0.006891226, 0.006753858, 0.006617308, 0.006481568, 0.006346627, 0.006212476, 0.006079107, 0.005946509, 0.005814675, 0.005683595, 0.005553262, 0.005423666, 0.005294799, 0.005166653, 0.005039220, 0.004912492, 0.004786462, 0.004661122, 0.004536463, 0.004412480, 0.004289165, 0.004166510, 0.004044509, 0.003923154, 0.003802439, 0.003682357, 0.003562902, 0.003444066, 0.003325844, 0.003208230, 0.003091216, 0.002974797, 0.002858967, 0.002743720, 0.002629050, 0.002514951, 0.002401417, 0.002288443, 0.002176023, 0.002064151, 0.001952823, 0.001842032, 0.001731774, 0.001622043, 0.001512834, 0.001404142, 0.001295961, 0.001188288, 0.001081116, 0.000974441, 0.000868259, 0.000762564, 0.000657351, 0.000552617, 0.000448356, 0.000344564, 0.000241236, 0.000138369, 0.000035956, -0.000066005, -0.000167519, -0.000268590, -0.000369223, -0.000469422, -0.000569190, -0.000668532, -0.000767453, -0.000865955, -0.000964043, -0.001061720, -0.001158991, -0.001255860, -0.001352329, -0.001448403, -0.001544086, -0.001639381, -0.001734291, -0.001828821, -0.001922973, -0.002016752, -0.002110160, -0.002203201, -0.002295879, -0.002388197, -0.002480158, -0.002571765, -0.002663021, -0.002753930, -0.002844495, -0.002934720]

fig, ax = plt.subplots()
font_size = 16

ax.scatter(time_1,   diff_1,          s=10,  label='1 ID',   c='grey',  marker='.')
ax.scatter(time_1,   cumul_diff_1,    s=10,  label='1 CD',   c='k',     marker='.')
ax.scatter(time_2,   diff_2,          s=10,  label='2 ID',   c='grey',  marker=10)
ax.scatter(time_2,   cumul_diff_2,    s=10,  label='2 CD',   c='k',     marker=10)
ax.scatter(time_4,   diff_4,          s=10,  label='4 ID',   c='grey',  marker=8)
ax.scatter(time_4,   cumul_diff_4,    s=10,  label='4 CD',   c='k',     marker=8)
ax.scatter(time_8,   diff_8,          s=10,  label='8 ID',   c='grey',  marker=9)
ax.scatter(time_8,   cumul_diff_8,    s=10,  label='8 CD',   c='k',     marker=9)
ax.scatter(time_16,  diff_16,         s=10,  label='16 ID',  c='grey',  marker=11)
ax.scatter(time_16,  cumul_diff_16,   s=10,  label='16 CD',  c='k',     marker=11)
#ax.scatter(time_32,  diff_32,         s=10,  label='32 ID',  c='grey',  marker=10)
#ax.scatter(time_32,  cumul_diff_32,   s=10,  label='32 CD',  c='k',     marker=10)
#ax.scatter(time_64,  diff_64,         s=10,  label='64 ID',  c='grey',  marker='_')
#ax.scatter(time_64,  cumul_diff_64,   s=10,  label='64 CD',  c='k',     marker='_')
#ax.scatter(time_128, diff_128,        s=10,  label='128 ID', c='grey',  marker='|')
#ax.scatter(time_128, cumul_diff_128,  s=10,  label='128 CD', c='k',     marker='|')
#ax.scatter(fluence, dpa_err, s=16, label='DPA Difference')
ax.set_xscale('linear')
ax.set_yscale('linear')
ax.legend(bbox_to_anchor=(1.02,1.03), loc='upper left', prop={'size': font_size})
ax.set_xlabel("Time [s]")
ax.set_ylabel("Relative Difference [-]")
xticks = [0, 1e+7, 2e+7, 3e+7, 4e+7, 5e+7]
ax.set_xticks(xticks)
yticks = [-0.03, 0, 0.03, 0.06]
#yticks = [-0.015, -0.01, -0.005, 0, 0.005, 0.01, 0.015]
ax.set_yticks(yticks)
ax.xaxis.label.set_fontsize(font_size)
ax.yaxis.label.set_fontsize(font_size)
# changes exponent size
temp = ax.xaxis.get_offset_text()
temp.set_size(font_size-2)
for item in ax.get_xticklabels() + ax.get_yticklabels():
    item.set_fontsize(font_size-2)
plt.xlim([0, 5.3e+7])
plt.ylim([-0.03, 0.07])
#plt.ylim([-0.016, 0.017])
#plt.locator_params(axis='|', numticks=5)
plt.subplots_adjust(right=0.76)
plt.show()

fig.savefig("quarter_pin_power_diff_1.pdf", format='PDF', bbox_inches='tight')
